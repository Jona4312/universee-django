{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %}Iniciar sesiÃ³n Â· UniversoE{% endblock %}
{% block content %}
<section class="auth-wrap" style="
  background: linear-gradient(180deg, #3b82f6 0%, #1e3a8a 100%);
  display: flex; align-items: center; justify-content: center;
  min-height: calc(100vh - 80px); padding: 40px 20px;
">
  <div class="auth-card" style="
    width: 100%; max-width: 380px; background: #fff; border-radius: 16px;
    box-shadow: 0 15px 35px rgba(0,0,0,.1); padding: 28px 24px; text-align: center;
  ">

    <h1 class="auth-title" style="
      font-size: 26px; font-weight: 900; color: #0f172a; margin-bottom: 18px;
    ">Iniciar sesiÃ³n</h1>

    {# SOLO errores del formulario, sin duplicar messages #}
    {% if form and form.non_field_errors %}
      <div style="text-align:left; margin-bottom:12px; background:#fef2f2; border:1px solid #fecaca; color:#991b1b; border-radius:10px; padding:10px 12px; font-size:14px;">
        {% for err in form.non_field_errors %}{{ err }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
      </div>
    {% endif %}

    <form method="post" action="{% url 'account_login' %}" class="auth-form" style="display:grid; gap:12px; text-align:left;">
      {% csrf_token %}
      {% if redirect_field_value %}
        <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}">
      {% endif %}

      <label for="id_login" style="font-weight:700; font-size:13px; color:#64748b;">Usuario o correo</label>
      <div class="form-group" style="position: relative;">
        <span style="position:absolute; top:50%; left:12px; transform:translateY(-50%); color:#9ca3af; font-size:16px;">ğŸ‘¤</span>
        <input type="text" name="login" id="id_login" required placeholder="tu usuario o correo@dominio.com" class="form-control"
               style="width:100%; height:42px; padding-left:40px; border:1px solid #e5e7eb; border-radius:10px; font-size:15px;"
               value="{% if form and form.data.login %}{{ form.data.login }}{% endif %}">
      </div>
      {% if form and form.login.errors %}
        <div style="color:#b91c1c; font-size:12px; margin-top:-6px; margin-bottom:4px;">
          {% for e in form.login.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
        </div>
      {% endif %}

      <label for="id_password" style="font-weight:700; font-size:13px; color:#64748b;">ContraseÃ±a</label>
      <div class="form-group" style="position: relative;">
        <span style="position:absolute; top:50%; left:12px; transform:translateY(-50%); color:#9ca3af; font-size:16px;">ğŸ”’</span>
        <input type="password" name="password" id="id_password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="form-control"
               style="width:100%; height:42px; padding-left:40px; padding-right: 40px; border:1px solid #e5e7eb; border-radius:10px; font-size:15px;">
        <button type="button" id="toggle-password" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #9ca3af; font-size: 1.2rem;">
          ğŸ‘ï¸
        </button>
      </div>
      {% if form and form.password.errors %}
        <div style="color:#b91c1c; font-size:12px; margin-top:-6px; margin-bottom:4px;">
          {% for e in form.password.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
        </div>
      {% endif %}

      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:4px;">
        <label style="display:inline-flex; align-items:center; gap:8px; color:#64748b; font-size:14px;">
          <input type="checkbox" name="remember" style="width:16px; height:16px;"> Recordarme
        </label>
        <a href="{% url 'account_reset_password' %}" style="font-weight:700; text-decoration:none; color:#4f46e5;">Â¿Olvidaste tu contraseÃ±a?</a>
      </div>

      <div class="auth-actions" style="display:flex; gap:10px; margin-top:8px;">
        <button type="submit" class="btn btn-primary" style="
          flex:1; background: linear-gradient(90deg, #6366f1, #06b6d4);
          color:#fff; font-weight:700; border:none; border-radius:10px; height:44px; transition:all .2s ease;
        ">Entrar</button>
        <a href="{% url 'account_signup' %}" class="btn btn-outline" style="
          flex:1; background:#f9fafb; color:#111827; font-weight:700;
          border:1px solid #e5e7eb; border-radius:10px; height:44px;
          display:flex; align-items:center; justify-content:center; text-decoration:none; transition:all .2s ease;
        ">Crear cuenta</a>
      </div>
    </form>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const passwordInput = document.getElementById('id_password');
  const toggleButton = document.getElementById('toggle-password');
  if (passwordInput && toggleButton) {
    toggleButton.addEventListener('click', function() {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      this.textContent = type === 'password' ? 'ğŸ‘ï¸' : 'ğŸ™ˆ';
    });
  }
});
</script>
{% endblock %}
