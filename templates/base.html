{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}UniversoE{% endblock %}</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  
  <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="{% static 'styles.css' %}?v=fix-nav-001">
  <meta name="color-scheme" content="light">
</head>

<body>
  <header class="site-nav">
    <nav class="site-nav-container">
      <div class="bar">
        <a href="{% url 'home' %}" class="brand">
          <span class="brand-badge">U</span>
          <span class="brand-name">UniversoE</span>
        </a>

        <div class="nav-links"></div>

        <div class="auth-links">
          {% if request.user.is_authenticated %}
            <a class="nav-btn-outline" href="{% url 'dashboard' %}">
              <span class="btn-text">Dashboard</span>
            </a>
            <a class="nav-btn-outline" href="{% url 'profile' %}">
              <span class="btn-text">Ver Perfil</span>
            </a>
            <form action="{% url 'account_logout' %}" method="post" style="margin: 0;">
              {% csrf_token %}
              <button type="submit" class="nav-btn-primary">
                <span class="btn-text">Salir</span>
              </button>
            </form>
          {% else %}
            <a class="nav-btn-outline" href="{% url 'account_signup' %}">
              <span class="btn-text">Crear cuenta</span>
            </a>
            <a class="nav-btn-primary" href="{% url 'account_login' %}">
              <span class="btn-text">Entrar</span>
            </a>
          {% endif %}
        </div>
      </div>
    </nav>
  </header>

  <main class="site-main-content">

    {% if messages %}
      <div class="container mt-3"> {# Puedes ajustar el contenedor si prefieres que ocupen todo el ancho #}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% block content %}{% endblock %}
    
  </main>

  <footer class="site-footer">
    <div class="site-footer-inner">
      <p>© 2025 UniversoE</p>
      <p class="footer-muted">Hecho para estudiantes — recursos, foros y tutorías.</p>
    </div>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const statsSection = document.querySelector(".stats");
      if (!statsSection) return;

      const counters = statsSection.querySelectorAll(".kpi[data-target]");
      
      const animateCount = (el) => {
        const target = +el.getAttribute("data-target");
        const suffix = el.getAttribute("data-suffix") || "";
        let current = 0;
        const duration = 2000;
        const increment = target / (duration / 16);
        
        const update = () => {
          current += increment;
          if (current < target) {
            el.textContent = "+" + Math.floor(current).toLocaleString();
            requestAnimationFrame(update);
          } else {
            el.textContent = "+" + target.toLocaleString();
          }
        };
        update();
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            counters.forEach(animateCount);
            observer.disconnect();
          }
        });
      }, { threshold: 0.5 });

      observer.observe(statsSection);
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  
</body>
</html>